# Docker Image

## 개요

모든 컨테이너는 이미지를 기반으로 생성되기 때문에 이미지를 다루는 방법은 도커 관리에 있어서 아주 중요하다.

## Docker Hub

도커는 기본적으로 도커 허브라는 중앙 이미지 저장소에서 이미지를 내려받게 된다. `docker create`, `docker run`, `docker pull`의 명령어로 이미지를 내려받을 때 도커는 도커 허브에서 해당 이미지를 검색한 뒤 내려받게 된다.

단, 도커 허브는 누구나 이미지를 올릴 수 있기 때문에 공식(Official) 라벨이 없는 이미지는 사용법을 찾을 수 없거나 제대로 동작하지 않을 수 있다. 도커 허브는 비공개 저장소의 수에 따라 요금을 지불해야 하므로, 이를 피하기 위해 도커 이미지 저장소를 직접 구축해 비공개로 사용할 수도 있다.

## 도커 이미지 생성

이미지를 `docker pull` 명령어로 내려받아 사용할 수도 있지만 도커로 개발하는 많은 경우에는 컨테이너에 애플리케이션을 위한 특정 개발 환경을 직접 구축한 뒤 사용자만의 이미지를 생성해야 한다.

먼저 컨테이너 내부에 first라는 이름의 파일을 하나 생성해 기존의 이미지로부터 변경사항을 만든다.

`test_first! >> first`

컨테이너에서 호스트로 빠져나와 `docker commit` 명령어를 입력해 컨테이너를 이미지로 만든다. 

```
docker commit [options] [image_name] [tag]
docker commit -a "author" -m "my first commit" commit_test commit_test:first
```

저장소(이미지) 이름은 입력하지 않아도 상관없지만 이미지의 태그를 입력하지 않으면 자동으로 latest로 설정된다. `-a` 옵션은 author를 뜻하며, 이미지의 작성자를 나타내는 메타데이터를 이미지에 포함시킨다. 

